# 前后端需求对齐清单（v2-draft）

> 目标：对 v1 中的 5 个待确认点给出“可直接拍板”的建议方案。
> 使用方式：你逐条回复“同意/调整”，我据此生成 `v2-final` 并落地代码。

## 1) 应用状态 `status` 枚举扩展

### 建议方案（推荐）

- 保留：`available`（可用）、`approval`（需申请）
- 新增：`beta`（试运行）、`offline`（已下线）

### 原因

- `beta` 适合内测应用灰度发布。
- `offline` 便于历史应用保留及榜单追溯。

### 前后端影响

- 后端：`App.status` 增加枚举值约束；列表过滤允许 4 态。
- 前端：卡片状态 Tag 增加 2 种样式；筛选下拉新增选项。

---

## 2) 榜单 `score` 语义与 `likes` 字段

### 建议方案（推荐）

- 固定 `score` 语义为“综合分”（非单一增长率）。
- 新增字段：`likes`（点赞数，可为空）
- 新增字段：`metric_type`（`composite` / `growth_rate` / `likes`）

### 原因

- 后续榜单口径可能变化，用 `metric_type` 避免前端硬编码。
- 趋势榜常见“点赞数/增速”并存，保留扩展位更稳。

### 前后端影响

- 后端：`Ranking` 增加 `likes`、`metric_type`。
- 前端：榜单行显示优先级 `metric_type` 决定文案与单位。

---

## 3) 申报接口字段扩展

### 建议方案（推荐）

在 `POST /api/submissions` 请求中新增：

- `scenario`：应用场景描述（string, 20-500）
- `data_level`：数据级别（`L1/L2/L3/L4`）
- `expected_benefit`：预期收益（string, 10-300）

### 原因

- 这 3 个字段是审批最关键信息，能显著减少补件沟通。

### 前后端影响

- 后端：`Submission` 模型和 Schema 扩展；增加字段校验。
- 前端：`我要申报` 表单补齐并做必填校验。

---

## 4) 规则链接 `href` 是否接 OA 内链

### 建议方案（推荐）

- 采用 OA 内链，统一走配置中心/环境变量管理。
- 新增后端配置：`OA_RULE_BASE_URL`。
- `rules` 接口返回完整 URL，前端只渲染，不拼接。

### 原因

- 避免前端硬编码内链地址，便于多环境切换。

### 前后端影响

- 后端：按环境生成规则链接。
- 前端：保留现有渲染逻辑即可。

---

## 5) 数据建模：单表 + `section` 还是分表

### 建议方案（推荐）

- 当前阶段继续 **单表 + `section` 枚举**。
- 当“集团/省内”字段差异超过 30% 再拆分子表（或一对一扩展表）。

### 原因

- 当前字段重合度高，单表开发与查询成本最低。
- 可通过索引（`section`, `status`, `category`）保障性能。

### 前后端影响

- 后端：无需立刻迁移；仅补索引和枚举约束。
- 前端：无改动。

---

## 一次性确认模板（请直接回复）

```text
1) status 扩展：同意 / 调整为 xxx
2) ranking 指标：同意 / 调整为 xxx
3) submissions 字段：同意 / 调整为 xxx
4) rules OA 内链：同意 / 调整为 xxx
5) 单表策略：同意 / 调整为 xxx
```

确认后我将：

1. 产出 `docs/alignment-v2-final.md`
2. 同步更新后端模型与接口
3. 同步更新前端状态与表单
4. 给你一版可验收的联调清单
